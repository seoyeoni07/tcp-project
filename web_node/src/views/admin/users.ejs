<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title><%= title %></title>

  <link rel="stylesheet" href="/css/design-system.css" />
  <link rel="stylesheet" href="/css/style.css" />
  <link rel="stylesheet" href="/css/nav.css" />
</head>
<body>
  <%- include("../partials/nav", { title, user, active: "admin" }) %>

  <div class="board-wrap">
    <div class="board-header">
      <h1 class="board-title">회원 관리</h1>
    </div>

    <div style="overflow-x:auto;">
      <table class="board-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>이름</th>
            <th>이메일</th>
            <th>부서</th>
            <th>직급</th>
            <th>연락처</th>
            <th>권한</th>
            <th>가입일</th>
            <th>관리</th>
          </tr>
        </thead>
        <tbody>
          <% if (users && users.length > 0) { %>
            <% users.forEach(function(u) { %>
              <tr>
                <td><%= u.user_id %></td>
                <td><%= u.user_name %></td>
                <td><%= u.email %></td>
                <td>
                  <form method="post" action="/admin/users/<%= u.user_id %>/update">
                    <input type="text" name="department" value="<%= u.department || '' %>" style="width:100px;">
                </td>
                <td>
                    <input type="text" name="position" value="<%= u.position || '' %>" style="width:100px;">
                </td>
                <td>
                  <input
                    type="text"
                    name="phone_number"
                    value="<%= u.phone_number || '' %>"
                    style="width:120px;"
                    placeholder="010-0000-0000"
                  >
              </td>
                <td>
                  <select name="role">
                    <option value="user" <%= u.role === 'user' ? 'selected' : '' %>>user</option>
                    <option value="admin" <%= u.role === 'admin' ? 'selected' : '' %>>admin</option>
                  </select>
                </td>
                <td><%= u.created_at.toISOString().slice(0,19).replace('T',' ') %></td>
                <td>
                    <button type="submit">저장</button>
                  </form>

                  <form method="post" action="/admin/users/<%= u.user_id %>/delete" style="margin-top:4px;">
                    <button type="submit" onclick="return confirm('정말 삭제하시겠습니까?');">
                      삭제
                    </button>
                  </form>
                </td>
              </tr>
            <% }) %>
          <% } else { %>
            <tr>
              <td colspan="9" style="text-align:center;">등록된 회원이 없습니다.</td>
            </tr>
          <% } %>
        </tbody>
      </table>
    </div>
  </div>

  <style>
    body {
      background: var(--bg-page);
    }

    .board-wrap {
      max-width: 1400px;
      margin: 40px auto;
      padding: 32px;
      background: white;
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-sm);
    }

    .board-header {
      margin-bottom: 28px;
    }

    .board-title {
      font-size: 24px;
      font-weight: 700;
      color: var(--text-primary);
      margin: 0;
    }

    .board-table {
      width: 100%;
      border-collapse: collapse;
      border-radius: var(--radius-md);
      overflow: hidden;
      box-shadow: 0 0 0 1px var(--border-color);
      font-size: 13px;
    }

    .board-table th,
    .board-table td {
      padding: 12px;
      text-align: center;
      border-bottom: 1px solid var(--border-color);
    }

    .board-table th {
      background-color: var(--bg-secondary);
      font-weight: 600;
      color: var(--text-primary);
      font-size: 13px;
      white-space: nowrap;
    }

    .board-table td {
      color: var(--text-secondary);
    }

    .board-table tbody tr:last-child td {
      border-bottom: none;
    }

    .board-table tbody tr:hover {
      background-color: #fafafa;
    }

    /* 입력 필드 */
    .board-table input[type="text"],
    .board-table select {
      width: 100%;
      padding: 6px 8px;
      border: 1px solid var(--border-color);
      border-radius: var(--radius-sm);
      font-size: 13px;
      outline: none;
      transition: border-color 0.2s;
    }

    .board-table input[type="text"]:focus,
    .board-table select:focus {
      border-color: var(--primary);
    }

    .board-table td:nth-child(4) input {
      max-width: 100px;
    }

    .board-table td:nth-child(5) input {
      max-width: 100px;
    }

    .board-table td:nth-child(6) input {
      max-width: 130px;
    }

    .board-table select {
      max-width: 90px;
      cursor: pointer;
    }

    .board-table form {
      margin: 0;
    }

    .board-table button {
      padding: 6px 12px;
      border: 1px solid var(--border-color);
      border-radius: var(--radius-sm);
      background: white;
      color: var(--text-secondary);
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      white-space: nowrap;
    }

    .board-table button:hover {
      background: var(--bg-secondary);
    }

    .board-table button[type="submit"]:first-of-type {
      background: var(--primary);
      border-color: var(--primary);
      color: white;
    }

    .board-table button[type="submit"]:first-of-type:hover {
      background: #1d4ed8;
      border-color: #1d4ed8;
    }

    .board-table td:last-child {
      white-space: nowrap;
    }

    .board-table td:last-child form {
      display: inline-block;
    }

    .board-table td:last-child form:first-child {
      margin-right: 4px;
    }

    .board-table td:last-child form:last-child button {
      background: #fef2f2;
      border-color: #fecaca;
      color: #dc2626;
    }

    .board-table td:last-child form:last-child button:hover {
      background: #fee2e2;
      border-color: #fca5a5;
    }

    .board-table td[colspan] {
      text-align: center;
      color: var(--text-tertiary);
      padding: 40px !important;
    }

    .board-wrap > div {
      overflow-x: auto;
    }
  </style>
</head>
</body>
</html>
